# Definition
directive @uppercase on FIELD_DEFINITION
directive @lowercase on FIELD_DEFINITION
directive @capitalize on FIELD_DEFINITION

enum MedicalErrorApparitionStep {
    FIRST_PRESCRIPTION_STEP
    SECOND_PRESCRIPTION_STEP
    ADMINISTRATION_STEP
    AFTER_SURVEILLANCE_STEP
    OTHER_STEP,
}


enum PharmaFormType {
    GEL
    GELULE
    COMPRIME
    POUDRE
    PANSEMENT
    SPRAY
    SIROP
    BUVABLE
    SUPOSITOIRE
    OTHER
}

enum MedicalErrorNature {
    PREPARATION_ERROR
    DELIVERANCE_ERROR
    ADMINISTRATION_ERROR
    PRESCRIPTION_ERROR
    THERAPEUTIC_CARE_ERROR,
    OTHER_ERROR,
}

type IndicatorValues {
    value: Int
    valuePercent: Int
}

type WithRepartition {
    with: IndicatorValues
    without: IndicatorValues
}

type RepartitionRange {
    id: Int
    range: String! @capitalize
    value: Int!
    valuePercent: String!
    description: String
}

type RepartitionPerSeriousEffect {
    range: String @capitalize
    value: Int
    valuePercent: Int
}

type Meta {
    count: Int
}

type Icon {
    id: Int!
    name: String
}

type PublicationType {
    id: Int
    name: String @capitalize
}

type Publication {
    id: Int!
    name: String! @capitalize
    type: PublicationType
    link: String
}

type PharmaForm {
    id: Int!
    name: String! @capitalize
    type: String!
}

type Laboratory {
    id: Int!
    name: String @capitalize
}

type MedicalError {
    name: String @capitalize
}

type MedicalATC {
    id: Int!
    code: String
    name: String @capitalize
}

type MedicalErrors {
    populationRepartition: [RepartitionRange]
    sideEffectsOriginRepartition: WithRepartition
    apparitionStepRepartition: [RepartitionRange]
    natureRepartition: [RepartitionRange]
}

type CisExposition {
    consumption: Int
    expositionLevel: String
    description: String
}

type RuptureClass {
    id: Int!
    name: String @capitalize
}

type RuptureCause {
    id: Int!
    name: String @capitalize
}

type SpecialityRupture {
    id: Int!
    num: String
    name: String @capitalize
    active: Boolean
    cause: RuptureCause @capitalize
    classification: RuptureClass
    date: String
}

type SpecialityRupturesHistory {
    ruptures: [SpecialityRupture]
    meta: Meta
}

type HltEffect {
    id: Int!
    range: String! @capitalize
    value: Int!
    valuePercent: Int!
}

type RepartitionPerGender {
    male: IndicatorValues
    female: IndicatorValues
}

type RepartitionPerNotifier {
    id: Int!
    job: String! @capitalize
    value: Int!
    valuePercent: Int!
}

type GlobStaticRepartitionPerNotifier {
    id: Int!
    job: String! @capitalize
    value: Int!
    valuePercent: Int!
}

type RepartitionPerPathology {
    id: Int!
    subId: Int!
    range: String! @capitalize
    value: Int!
    valuePercent: Int!
    htlEffects: [HltEffect]
}

type  GlobStaticRepartitionPerPathology {
    id: Int!
    range: String @capitalize
    value: Int!
    valuePercent: Int!
}

type RepartitionPerGravity {
    range: String @capitalize
    value: Int!
    valuePercent: Int!
}

type TotalExposition {
    total: Int!
    minYear: Int
    maxYear: Int
}

type RuptureTotalExposition {
    total: Int!
    year: Int!
    ruptureExpositions: [RuptureExposition]
}

type RuptureExposition {
    range: String @capitalize
    value: Int!
    valuePercent: Int!
}

type Substance {
    id: Int!
    code: String!
    name: String! @capitalize
    retrieveSpecialities: SpecialitiesReturn
    repartitionPerGender: RepartitionPerGender
    repartitionPerAge: [RepartitionRange]
    repartitionPerNotifier: [RepartitionPerNotifier]
    repartitionPerPathology: [RepartitionPerPathology]
    totalExposition: TotalExposition
    exposition: CisExposition
}

type SpecialitySubstance {
    id: Int!
    code: String!
    name: String! @capitalize
    dosage: String
}

type Speciality {
    id: Int!
    code: String!
    name: String! @capitalize
    atc: MedicalATC
    icon: Icon
    dosageIndication: String
    substances: [Substance]
    dosageSubstances: [SpecialitySubstance]
    pharmaForm: PharmaForm
    description: String
    commercialisationState: String @capitalize
    commercialisationType: String @capitalize
    laboratory: Laboratory @capitalize
    repartitionPerGender: RepartitionPerGender
    repartitionPerAge: [RepartitionRange]
    exposition: CisExposition
    medicalErrors: MedicalErrors
    publications: [Publication]
    rupturesHistory: SpecialityRupturesHistory
}

type SpecialityLight {
    id: Int!
    code: String!
    name: String! @capitalize
    description: String
    exposition: CisExposition
}

type GlobalStatistic {
    totalExposition: TotalExposition
    repartitionPerGender: RepartitionPerGender
    repartitionPerAge: [RepartitionRange]
    repartitionPerSeriousEffect: [RepartitionPerSeriousEffect]
    repartitionPerPathology: [GlobStaticRepartitionPerPathology]
    repartitionPerNotifier: [GlobStaticRepartitionPerNotifier]
    repartitionPerGravity: [RepartitionPerGravity]
}

type RuptureYear {
    value: Int
}

type RuptureStock {
    year: Int
    total: Int
    nbRisque: Int
    nbRupture: Int
    nbRisqueClosed: Int
    nbRuptureClosed: Int
}

type RuptureClassificationRepartition {
    year: Int
    classification: String
    value: Int
}

type TherapeuticClassRupture {
    name: String
    value: Int
    totalCis: Int
}

type TherapeuticClassesRupturesPerYear {
    year: Int
    repartition: [TherapeuticClassRupture]
    total: Int
}

type Cause {
    range: String
    value: Int
}

type RuptureCauseRepartition {
    causes: [Cause]
    year: Int
    total: Int
}

type RuptureTotalAction {
    year: Int
    total: Int
    totalWithAtLeastOneAction: Int
}

type RuptureAction {
    range: String
    value: Int
}

type RuptureActionRepartition {
    year: Int
    actions: [RuptureAction]
    total: Int
}

type GlobalRuptures {
    ruptureStocks: [RuptureStock]
    ruptureYears: [RuptureYear]
    repartitionPerClassification: [RuptureClassificationRepartition]
    repartitionPerTherapeuticClass: [TherapeuticClassesRupturesPerYear]
    repartitionPerCause: [RuptureCauseRepartition]
    repartitionPerAction: [RuptureActionRepartition]
    totalAction: [RuptureTotalAction]
}

##### QUERIES #####

type SpecialitiesReturn {
    specialities: [SpecialityLight]
    meta: Meta
}

type SubstancesReturn {
    substances: [Substance]
    meta: Meta
}

type Query {
    getSpeciality(cisCode: String!): Speciality
    getSpecialities: SpecialitiesReturn
    getSubstance(subCode: String!): Substance
    getSubstances: SubstancesReturn
    getGlobalStatistic: GlobalStatistic
    getGlobalRuptures: GlobalRuptures
}

type LoginResult {
    token: String
}

type Mutation {
    login(username: String, password: String): LoginResult
}
