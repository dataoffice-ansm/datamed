fragment SpecialityFragment on Speciality {
    id
    name
    code
    atc {
        id
        name
        code
    }
    pharmaForm {
        id
        label
        type
    }
    substances {
        ...SubstanceFragment
    }
    dosageIndication
    dosageSubstances {
        id
        code
        name
        dosage
    }
    commercialisationState
    commercialisationType
    repartitionPerGender {
        male {
            value
            valuePercent
        }
        female {
            value
            valuePercent
        }
    }
    repartitionPerAge {
        range
        value
        valuePercent
    }
    publications {
        id
        name
        link
        type {
            id
            name
        }
    }
    laboratory {
        id
        name
    }
    exposition {
        consumption
        expositionCode
        expositionLevel
        description
        minYear
        maxYear
    }
    medicalErrors {
        populationRepartition {
            id
            range
            description
            value
            valuePercent
        }
        sideEffectsOriginRepartition {
            with {
                value
                valuePercent
            }
            without {
                value
                valuePercent
            }
        }
        apparitionStepRepartition {
            id
            step
            label
            value
            valuePercent
            description
        }
        natureRepartition {
            id
            nature
            value
            valuePercent
        }
    }
    rupturesHistory {
        ruptures {
            id
            num
            name
            active
            date
            cause {
                id
                type
            }
            classification {
                id
                label
            }
        }
        meta {
            count
        }
    }
}

fragment SubstanceFragment on Substance {
    id
    code
    name
    retrievedSpecialities {
        meta {
            count
        }
        specialities {
            id
            code
            name
        }
    }
    repartitionPerGender {
        male {
            value
            valuePercent
        }
        female {
            value
            valuePercent
        }
    }
    repartitionPerAge {
        range
        value
        valuePercent
    }
    sideEffects {
        declarations {
            total
        }
        repartitionPerGender {
            male {
                value
                valuePercent
            }
            female {
                value
                valuePercent
            }
        }
        repartitionPerAge {
            range
            value
            valuePercent
        }
        repartitionPerNotifier {
            id
            job
            value
            valuePercent
        }

        repartitionPerPathology {
            id
            range
            value
            valuePercent
            htlEffects {
                id
                socId
                range
                value
                valuePercent
            }
        }
    }
    exposition {
        consumption
        expositionCode
        expositionLevel
        description
        minYear
        maxYear
    }
}

query Speciality($cisCode: String!) {
    getSpeciality(cisCode: $cisCode) {
        ...SpecialityFragment
    }
}

query Specialities {
    getSpecialities {
        meta {
            count
        }
        specialities {
            id
            code
            name
        }
    }
}

query Substance($subCode: String!) {
    getSubstance(subCode: $subCode) {
        ...SubstanceFragment
    }
}

query Substances {
    getSubstances {
        meta {
            count
        }
        substances {
            id
            name
            code
        }
    }
}

query GlobalStatistic {
    getGlobalStatistic {
        repartitionPerGender {
            male {
                value
                valuePercent
            }
            female {
                value
                valuePercent
            }
        }
        repartitionPerAge {
            id
            range
            value
            valuePercent
        }
        exposition {
            consumption
            minYear
            maxYear
        }
        repartitionPerSeriousEffect {
            value
            range
            valuePercent
        }
        repartitionPerPathology {
            valuePercent
            value
            range
        }
        repartitionPerNotifier {
            id
            job
            value
            valuePercent
        }

        repartitionPerGravity {
            range
            value
            valuePercent
        }
    }
}

query GlobalRuptures {
    getGlobalRuptures {
        config {
            minYear
            maxYear
        }
        ruptureStocks {
            year
            nbDeclarations
            nbRisque
            nbRisqueClosed
            nbRuptureClosed
            nbRupture
        }
        ruptureYears
        repartitionPerClassification {
            value
            classification
            year
        }
        repartitionPerTherapeuticClass {
            year
            total
            repartition {
                atcId
                atcName
                value
                totalCis
            }
        }
        repartitionPerCause {
            year
            causes {
                value
                range
                description
            }
            total
        }
        repartitionPerAction {
            year
            total
            actions {
                value
                range
                description
            }
        }
        totalActions {
            year
            totalMeasures
            totalDeclarationsWithMeasure{
                value
                valuePercent
            }
        }
    }
}

mutation Login($username:String,$password:String) {
    login(username: $username, password:$password){
        token
    }
}